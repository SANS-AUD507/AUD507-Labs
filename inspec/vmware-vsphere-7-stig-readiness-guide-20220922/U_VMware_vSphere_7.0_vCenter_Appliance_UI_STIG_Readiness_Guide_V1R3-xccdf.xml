<?xml version="1.0" encoding="UTF-8"?><?xml-stylesheet type="text/xsl" href="STIG_unclass.xsl"?>
<Benchmark xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsdhttp://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="vCenter UI" xml:lang="en" xmlns="http://checklists.nist.gov/xccdf/1.1">
  <status date="2022-05-03">draft</status>
  <title>VMware vSphere 7.0 vCenter Appliance UI STIG Readiness Guide</title>
  <description/>
  <notice id="terms-of-use" xml:lang="en"/>
  <front-matter xml:lang="en"/>
  <rear-matter xml:lang="en"/>
  <reference href="">
    <dc:publisher/>
    <dc:source/>
  </reference>
  <plain-text id="release-info">Release: 3 Benchmark Date: 3 May 2022</plain-text>
  <plain-text id="generator">3.2.2.36079</plain-text>
  <plain-text id="conventionsVersion">1.10.0</plain-text>
  <version>1</version>
  <Group id="VCUI-70-000001">
    <title>SRG-APP-000001-WSR-000001</title>
    <Rule id="SV-VCUI-70-000001" severity="medium" weight="10.0">
      <version>VCUI-70-000001</version>
      <title>vSphere UI must limit the amount of time that each TCP connection is kept alive.</title>
      <description>&lt;VulnDiscussion&gt;Denial of Service (DoS) is one threat against web servers.  Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests. 

In Tomcat, the "connectionTimeout" attribute sets the number of milliseconds the server will wait after accepting a connection for the request URI line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000054</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Configure the http &lt;Connector&gt; node with the value:

connectionTimeout="300000"

Example:

&lt;Connector .. connectionTimeout="300000" ..&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --xpath '/Server/Service/Connector[@port="${http.port}"]/@connectionTimeout' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

connectionTimeout="300000"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000002">
    <title>SRG-APP-000001-WSR-000001</title>
    <Rule id="SV-VCUI-70-000002" severity="medium" weight="10.0">
      <version>VCUI-70-000002</version>
      <title>vSphere UI must limit the number of concurrent connections permitted.</title>
      <description>&lt;VulnDiscussion&gt;Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.

Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. Each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the "maxThreads" attribute.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000054</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Configure each &lt;Connector&gt; node with the value:

maxThreads="800"

Example:

&lt;Connector .. maxThreads="800" ..&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --xpath '/Server/Service/Connector[@port="${http.port}"]/@maxThreads' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

maxThreads="800"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000003">
    <title>SRG-APP-000001-WSR-000001</title>
    <Rule id="SV-VCUI-70-000003" severity="medium" weight="10.0">
      <version>VCUI-70-000003</version>
      <title>vSphere UI must limit the maximum size of a POST request.</title>
      <description>&lt;VulnDiscussion&gt;The "maxPostSize" value is the maximum size in bytes of the POST which will be handled by the container FORM URL parameter parsing. Limit its size to reduce exposure to a denial-of-service attack.

If "maxPostSize" is not set, the default value of 2097152 (2MB) is used. The vSphere UI is configured in it's shipping state to not set a value for "maxPostSize".&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000054</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to each of the &lt;Connector&gt; nodes.

Remove any configuration for "maxPostSize".

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --xpath '/Server/Service/Connector[@port="${http.port}"]/@maxPostSize' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

XPath set is empty

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000004">
    <title>SRG-APP-000001-WSR-000002</title>
    <Rule id="SV-VCUI-70-000004" severity="medium" weight="10.0">
      <version>VCUI-70-000004</version>
      <title>vSphere UI must protect cookies from XSS.</title>
      <description>&lt;VulnDiscussion&gt;Cookies are a common way to save session state over the HTTP(S) protocol. If an attacker can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. When you tag a cookie with the "HttpOnly" flag, it tells the browser that this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.

Satisfies: SRG-APP-000439-WSR-000154&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000054</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/context.xml

Add the following configuration to the &lt;Context&gt; node:

useHttpOnly="true"

Example:

&lt;Context useHttpOnly="true" sessionCookieName="VSPHERE-UI-JSESSIONID" sessionCookiePath="/ui"&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/context.xml | xmllint --xpath '/Context/@useHttpOnly' -

Expected result:

useHttpOnly="true"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000005">
    <title>SRG-APP-000016-WSR-000005</title>
    <Rule id="SV-VCUI-70-000005" severity="medium" weight="10.0">
      <version>VCUI-70-000005</version>
      <title>vSphere UI must record user access in a format that enables monitoring of remote access.</title>
      <description>&lt;VulnDiscussion&gt;Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.

Tomcat can be configured with an "AccessLogValve", a component that can be inserted into the request processing pipeline to provide robust access logging. The Access Log Valve creates log files in the same format as those created by standard web servers. When AccessLogValve is properly configured, log files will contain all the forensic information necessary in the case of a security incident.

Satisfies: SRG-APP-000095-WSR-000056, SRG-APP-000098-WSR-000059, SRG-APP-000375-WSR-000171, SRG-APP-000096-WSR-000057, SRG-APP-000093-WSR-000053, SRG-APP-000089-WSR-000047, SRG-APP-000097-WSR-000058, SRG-APP-000098-WSR-000060, SRG-APP-000099-WSR-000061, SRG-APP-000100-WSR-000064, SRG-APP-000374-WSR-000172&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000067</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Ensure the log pattern in the "org.apache.catalina.valves.AccessLogValve" node is set to the following:

pattern="%h %{x-forwarded-for}i %l %u %t &amp;quot;%r&amp;quot; %s %b %{#hashedClientId#}s %{#hashedRequestId#}r %I %D"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | xmllint --xpath '/Server/Service/Engine/Host/Valve[@className="org.apache.catalina.valves.AccessLogValve"]/@pattern' -

Expected result:

pattern="%h %{x-forwarded-for}i %l %u %t &amp;quot;%r&amp;quot; %s %b %{#hashedClientId#}s %{#hashedRequestId#}r %I %D"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000006">
    <title>SRG-APP-000089-WSR-000047</title>
    <Rule id="SV-VCUI-70-000006" severity="medium" weight="10.0">
      <version>VCUI-70-000006</version>
      <title>vSphere UI must generate log records for system startup and shutdown.</title>
      <description>&lt;VulnDiscussion&gt;Logging must be started as soon as possible when a service starts and when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.

On the VCSA, the "vmware-vmon" service starts up the JVMs for various vCenter processes, including vSphere UI, and the individual json config files control the early jvm logging. Ensuring these json files are configured correctly enables early Java stdout and stderr logging.

Satisfies: SRG-APP-000092-WSR-000055&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000169</ident>
      <fixtext>Navigate to and open:

/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json

Below the last line of the "PreStartCommandArg" block add or re-configure the following line:

"StreamRedirectFile": "%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log",

Restart the appliance for changes to take effect.</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json

Expected result:

"StreamRedirectFile": "%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log",

If there is no log file specified for the StreamRedirectFile setting, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000007">
    <title>SRG-APP-000118-WSR-000068</title>
    <Rule id="SV-VCUI-70-000007" severity="medium" weight="10.0">
      <version>VCUI-70-000007</version>
      <title>vSphere UI log files must only be accessible by privileged users.</title>
      <description>&lt;VulnDiscussion&gt;Log data is essential in the investigation of events. If log data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve.

In addition, access to log records provides information an attacker could potentially use to their advantage since each event record might contain communication ports, protocols, services, trust relationships, user names, etc. The vSphere UI restricts all access to log file by default but this configuration must be verified.

Satisfies: SRG-APP-000119-WSR-000069, SRG-APP-000120-WSR-000070&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000162</ident>
      <fixtext>At the command prompt, execute the following command(s):

# chmod 600 /storage/log/vmware/vsphere-ui/logs/&lt;file&gt;
# chown vsphere-ui:users /storage/log/vmware/vsphere-ui/logs/&lt;file&gt;

Note: Substitute &lt;file&gt; with the listed file.</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# find /storage/log/vmware/vsphere-ui/logs/ -xdev -type f -a '(' -not -perm 600 -o -not -user vsphere-ui -o -not -group users ')' -exec ls -ld {} \;

If any files are returned, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000008">
    <title>SRG-APP-000131-WSR-000051</title>
    <Rule id="SV-VCUI-70-000008" severity="medium" weight="10.0">
      <version>VCUI-70-000008</version>
      <title>vSphere UI application files must be verified for their integrity.</title>
      <description>&lt;VulnDiscussion&gt;Verifying that the vSphere UI application code is unchanged from its shipping state is essential for file validation and non-repudiation of the vSphere UI. There is no reason that the MD5 hash of the rpm original files should be changed after installation, excluding configuration files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001749</ident>
      <fixtext>Reinstall the VCSA or roll back to a snapshot.

Modifying the vSphere UI installation files manually is not supported by VMware.</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# rpm -V vsphere-ui|grep "^..5......"|grep -v -E "\.prop|\.pass|\.xml"

If is any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000009">
    <title>SRG-APP-000131-WSR-000073</title>
    <Rule id="SV-VCUI-70-000009" severity="medium" weight="10.0">
      <version>VCUI-70-000009</version>
      <title>vSphere UI plugins must be authorized before use.</title>
      <description>&lt;VulnDiscussion&gt;The vSphere UI ships with a number of plugins out of the box. Any additional plugins may affect the availability and integrity of the system and must be approved and documented by the ISSO before deployment.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001749</ident>
      <fixtext>For every unauthorized plugin returned by the check, run the following command:

# rm &lt;file&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# diff &lt;(find /usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins -type f|sort) &lt;(rpm -ql vsphere-ui|grep "/usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins/"|sort)

If there is any output, this indicates a vSphere UI plugin is present that does not ship with the VCSA.

If this plugin is not known and approved, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000010">
    <title>SRG-APP-000141-WSR-000015</title>
    <Rule id="SV-VCUI-70-000010" severity="medium" weight="10.0">
      <version>VCUI-70-000010</version>
      <title>vSphere UI must not be configured with the UserDatabaseRealm enabled.</title>
      <description>&lt;VulnDiscussion&gt;The vSphere UI performs user authentication at the application level and not through Tomcat. By default, there is no configuration for the UserDatabaseRealm Tomcat authentication mechanism. To eliminate unnecessary features and to ensure that the vSphere UI remains in it's shipping state, the lack of a UserDatabaseRealm configuration must be confirmed.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Remove any and all &lt;Realm&gt; nodes.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# grep UserDatabaseRealm /usr/lib/vmware-vsphere-ui/server/conf/server.xml

If the command produces any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000011">
    <title>SRG-APP-000141-WSR-000075</title>
    <Rule id="SV-VCUI-70-000011" severity="medium" weight="10.0">
      <version>VCUI-70-000011</version>
      <title>vSphere UI must be configured to limit access to internal packages.</title>
      <description>&lt;VulnDiscussion&gt;The "package.access" entry in the catalina.properties file implements access control at the package level. When properly configured, a Security Exception will be reported should an errant or malicious webapp attempt to access the listed internal classes directly, or if a new class is defined under the protected packages.

The vSphere UI comes pre-configured with the appropriate packages defined in "package.access" and this configuration must be maintained. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties

Ensure that the "package.access" line is configured as follows:

package.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.jasper.,org.apache.tomcat.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# grep "package.access" /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Expected result:

package.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.jasper.,org.apache.tomcat.

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000012">
    <title>SRG-APP-000141-WSR-000081</title>
    <Rule id="SV-VCUI-70-000012" severity="medium" weight="10.0">
      <version>VCUI-70-000012</version>
      <title>vSphere UI must have Multipurpose Internet Mail Extensions (MIME) that invoke operating system shell programs disabled.</title>
      <description>&lt;VulnDiscussion&gt;MIME mappings tell the vSphere UI what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type. By ensuring that various shell script MIME types are not included in web.xml, the server is protected against malicious users tricking the server into executing shell command files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Remove any and all of the following nodes lines:

&lt;mime-type&gt;application/x-csh&lt;/mime-type&gt;
&lt;mime-type&gt;application/x-shar&lt;/mime-type&gt;
&lt;mime-type&gt;application/x-sh&lt;/mime-type&gt;
&lt;mime-type&gt;application/x-ksh&lt;/mime-type&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui

Note: Delete the entire mime-mapping node for the target mime-type.

Example:

&lt;mime-mapping&gt;
    &lt;extension&gt;sh&lt;/extension&gt;
    &lt;mime-type&gt;application/x-sh&lt;/mime-type&gt;
&lt;/mime-mapping&gt;</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# grep -En '(x-csh&lt;)|(x-sh&lt;)|(x-shar&lt;)|(x-ksh&lt;)' /usr/lib/vmware-vsphere-ui/server/conf/web.xml

If the command produces any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000013">
    <title>SRG-APP-000141-WSR-000083</title>
    <Rule id="SV-VCUI-70-000013" severity="medium" weight="10.0">
      <version>VCUI-70-000013</version>
      <title>vSphere UI must have mappings set for Java servlet pages.</title>
      <description>&lt;VulnDiscussion&gt;Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and identify which file types are not to be delivered to a client.

By not specifying which files can and cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc. 

As Tomcat is a Java-based web server, the main file extension used is *.jsp. This check ensures that the *.jsp and *.jspx file types has been properly mapped to servlets.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to and locate the mapping for the JSP servlet.  It is the  &lt;servlet-mapping&gt; node that contains &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;

Configure the &lt;servlet-mapping&gt; node to look like the code snippet below:

    &lt;!-- The mappings for the JSP servlet --&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
        &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;
        &lt;url-pattern&gt;*.jspx&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command: 

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '/web-app/servlet-mapping/servlet-name[text()="jsp"]/parent::servlet-mapping' -

Expected result:

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
    &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;
    &lt;url-pattern&gt;*.jspx&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

If the jsp and jspx file url-patterns are not configured as in the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000014">
    <title>SRG-APP-000141-WSR-000085</title>
    <Rule id="SV-VCUI-70-000014" severity="medium" weight="10.0">
      <version>VCUI-70-000014</version>
      <title>vSphere UI must not have the Web Distributed Authoring (WebDAV) servlet installed.</title>
      <description>&lt;VulnDiscussion&gt;WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server and must therefore be disabled.

Tomcat uses the "org.apache.catalina.servlets.WebdavServlet" servlet to provide WebDAV services. Because the WebDAV service has been found to have an excessive number of vulnerabilities, this servlet must not be installed. vSphere UI does not configure WebDAV by default.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml.

Find the &lt;servlet-name&gt;webdav&lt;/servlet-name&gt; node and remove the entire parent &lt;servlet&gt; block.

Find the &lt;servlet-name&gt;webdav&lt;/servlet-name&gt; node and remove the entire parent &lt;servlet-mapping&gt; block.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command: 

# grep -n 'webdav' /usr/lib/vmware-vsphere-ui/server/conf/web.xml

If the command produces any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000015">
    <title>SRG-APP-000141-WSR-000086</title>
    <Rule id="SV-VCUI-70-000015" severity="medium" weight="10.0">
      <version>VCUI-70-000015</version>
      <title>vSphere UI must be configured with memory leak protection.</title>
      <description>&lt;VulnDiscussion&gt;The Java Runtime environment can cause a memory leak or lock files under certain conditions. Without memory leak protection, vSphere UI can continue to consume system resources which will lead to "OutOfMemoryErrors" when reloading web applications.

Memory leaks occur when JRE code uses the context class loader to load a singleton, as this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The "JreMemoryLeakPreventionListener" class is designed to initialise these singletons when Tomcat's common class loader is the context class loader. Proper use of JRE memory leak protection will ensure that the hosted application does not consume system resources and cause an unstable environment.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Server&gt; node.

Add '&lt;Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener"/&gt;' to the &lt;Server&gt; node.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command: 

# grep JreMemoryLeakPreventionListener /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

&lt;Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener"/&gt;

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000016">
    <title>SRG-APP-000141-WSR-000087</title>
    <Rule id="SV-VCUI-70-000016" severity="medium" weight="10.0">
      <version>VCUI-70-000016</version>
      <title>vSphere UI must not have any symbolic links in the web content directory tree.</title>
      <description>&lt;VulnDiscussion&gt;A web server is designed to deliver content and execute scripts or applications on the request of a client or user. Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees that the user is not accessing information protected outside the application's realm.

By checking that no symbolic links exist in the document root, the web server is protected from users jumping outside the hosted application directory tree and gaining access to the other directories, including the system root.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
      <fixtext>At the command prompt, execute the following command:

Note: Replace &lt;file_name&gt; for the name of any files that were returned.

unlink &lt;file_name&gt;

Repeat the command for each file that was returned.</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# find /usr/lib/vmware-vsphere-ui/server/static/ -type l -ls

If the command produces any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000017">
    <title>SRG-APP-000211-WSR-000030</title>
    <Rule id="SV-VCUI-70-000017" severity="medium" weight="10.0">
      <version>VCUI-70-000017</version>
      <title>vSphere UI directory tree must have permissions in an "out-of-the-box" state.</title>
      <description>&lt;VulnDiscussion&gt;As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. The vSphere UI files must be adequately protected with correct permissions as applied "out of the box".

Satisfies: SRG-APP-000380-WSR-000072&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001082</ident>
      <fixtext>At the command prompt, execute the following command(s):

# chmod o-w &lt;file&gt;
# chown root:root &lt;file&gt;

Repeat the commands for each file that was returned.</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# find /usr/lib/vmware-vsphere-ui/server/lib /usr/lib/vmware-vsphere-ui/server/conf -xdev -type f -a '(' -perm -o+w -o -not -user root -o -not -group root ')' -exec ls -ld {} \;

If the command produces any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000018">
    <title>SRG-APP-000223-WSR-000011</title>
    <Rule id="SV-VCUI-70-000018" severity="medium" weight="10.0">
      <version>VCUI-70-000018</version>
      <title>vSphere UI must restrict it's cookie path.</title>
      <description>&lt;VulnDiscussion&gt;Cookies are used to exchange data between the web server and the client. Cookies, such as a session cookie, may contain session information and user credentials used to maintain a persistent connection between the user and the hosted application since HTTP/HTTPS is a stateless protocol.

vSphere UI is bound to the "/ui" virtual path behind the reverse proxy and it's cookies are configured as such. This configuration must be confirmed and maintained.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001664</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/context.xml

Add the following configuration to the &lt;Context&gt; node:

sessionCookiePath="/ui"

Example:

&lt;Context useHttpOnly="true" sessionCookieName="VSPHERE-UI-JSESSIONID" sessionCookiePath="/ui"&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/context.xml | xmllint --xpath '/Context/@sessionCookiePath' -

Expected result:

sessionCookiePath="/ui"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000019">
    <title>SRG-APP-000225-WSR-000140</title>
    <Rule id="SV-VCUI-70-000019" severity="medium" weight="10.0">
      <version>VCUI-70-000019</version>
      <title>vSphere UI must fail to a known safe state if system initialization fails, shutdown fails, or aborts fail.</title>
      <description>&lt;VulnDiscussion&gt;Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. For the Security Token Service, it is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentailly insecure, state.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001190</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Add or change the following line:

org.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command line, execute the following command:

# grep EXIT_ON_INIT_FAILURE /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Expected result :

org.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000020">
    <title>SRG-APP-000246-WSR-000149</title>
    <Rule id="SV-VCUI-70-000020" severity="medium" weight="10.0">
      <version>VCUI-70-000020</version>
      <title>vSphere UI must limit the number of allowed connections.</title>
      <description>&lt;VulnDiscussion&gt;Limiting the number of established connections is a basic denial of service protection and a best practice. Servers where the limit is too high or unlimited can potentiall run out of system resources and negatively affect system availability.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001094</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Connector&gt; configured with port="${http.port}".

Add or change the folllowing value:

acceptCount="300"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --xpath '/Server/Service/Connector[@port="${http.port}"]/@acceptCount' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

acceptCount="300"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000021">
    <title>SRG-APP-000251-WSR-000157</title>
    <Rule id="SV-VCUI-70-000021" severity="medium" weight="10.0">
      <version>VCUI-70-000021</version>
      <title>vSphere UI must set URIEncoding to UTF-8.</title>
      <description>&lt;VulnDiscussion&gt;Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application. 

An attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. vSphere UI must be configured to use a consistent character set via the URIEncoding attribute on the Connector nodes.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001310</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to each of the &lt;Connector&gt; nodes.

Configure each &lt;Connector&gt; node with the value 'URIEncoding="UTF-8"'.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --xpath '/Server/Service/Connector[@port="${http.port}"]/@URIEncoding' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

URIEncoding="UTF-8"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000022">
    <title>SRG-APP-000266-WSR-000142</title>
    <Rule id="SV-VCUI-70-000022" severity="medium" weight="10.0">
      <version>VCUI-70-000022</version>
      <title>vSphere UI must set the welcome-file node to a default web page.</title>
      <description>&lt;VulnDiscussion&gt;Enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed.

By having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version. Ensuring that every document directory has an "index.jsp" (or equivalent) file is one approach to mitigating the vulnerability.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001312</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Add the following section under the &lt;web-apps&gt; node:

    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;
        &lt;welcome-file&gt;index.htm&lt;/welcome-file&gt;
        &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:
 
# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '/web-app/welcome-file-list' -

Expected result:

&lt;welcome-file-list&gt;
    &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;
    &lt;welcome-file&gt;index.htm&lt;/welcome-file&gt;
    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
&lt;/welcome-file-list&gt;

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000023">
    <title>SRG-APP-000266-WSR-000142</title>
    <Rule id="SV-VCUI-70-000023" severity="medium" weight="10.0">
      <version>VCUI-70-000023</version>
      <title>The vSphere UI must not show directory listings.</title>
      <description>&lt;VulnDiscussion&gt;Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001312</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Set the &lt;param-value&gt; to "false" in all &lt;param-name&gt;listing&lt;/param-name&gt; nodes.

Note: The setting should look like the following:

&lt;init-param&gt;
      &lt;param-name&gt;listings&lt;/param-name&gt;
      &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '//param-name[text()="listings"]/parent::init-param' -

Expected result:

&lt;init-param&gt;
      &lt;param-name&gt;listings&lt;/param-name&gt;
      &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000024">
    <title>SRG-APP-000266-WSR-000159</title>
    <Rule id="SV-VCUI-70-000024" severity="medium" weight="10.0">
      <version>VCUI-70-000024</version>
      <title>vSphere UI must be configured to hide the server version.</title>
      <description>&lt;VulnDiscussion&gt;Web servers will often display error messages to client users with enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, vSphere UI must be configured to hide the server version at all times.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001312</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to each of the &lt;Connector&gt; nodes.

Configure each &lt;Connector&gt; node with 'server="Anonymous"'.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --xpath '/Server/Service/Connector[@port="${http.port}"]/@server' /usr/lib/vmware-vsphere-ui/server/conf/server.xml 

Expected result:

server="Anonymous"

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000025">
    <title>SRG-APP-000266-WSR-000159</title>
    <Rule id="SV-VCUI-70-000025" severity="medium" weight="10.0">
      <version>VCUI-70-000025</version>
      <title>vSphere UI must be configured to show error pages with minimal information.</title>
      <description>&lt;VulnDiscussion&gt;Web servers will often display error messages to client users with enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, vSphere UI must be configured to not show server version information in error pages.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001312</ident>
      <fixtext>Navigate to and open:

 /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Locate the following Host block:

&lt;Host ...&gt;
...
&lt;/Host&gt;

Inside this block, remove any existing Valve with className="org.apache.catalina.valves.ErrorReportValve" and add the following:

&lt;Valve className="org.apache.catalina.valves.ErrorReportValve" showServerInfo="false" showReport="false"/&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | xmllint --xpath '/Server/Service/Engine/Host/Valve[@className="org.apache.catalina.valves.ErrorReportValve"]' -

Expected result:

&lt;Valve className="org.apache.catalina.valves.ErrorReportValve" showServerInfo="false" showReport="false"/&gt;

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000026">
    <title>SRG-APP-000266-WSR-000160</title>
    <Rule id="SV-VCUI-70-000026" severity="medium" weight="10.0">
      <version>VCUI-70-000026</version>
      <title>vSphere UI must not enable support for TRACE requests.</title>
      <description>&lt;VulnDiscussion&gt;"TRACE" is a technique for a user to request internal information about Tomcat. This is useful during product development, but should not be enabled in production. Allowing a attacker to conduct a TRACE operation against the web service will expose information that would be useful to perform a more targeted attack. vSphere UI provides the "allowTrace" parameter as means to disable responding to TRACE requests.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001312</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to and locate 'allowTrace="true"'.

Remove the 'allowTrace="true"' setting.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# grep allowTrace /usr/lib/vmware-vsphere-ui/server/conf/server.xml

If "allowTrace" is set to "true", this is a finding.

If no line is returned, this is NOT a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000027">
    <title>SRG-APP-000266-WSR-000160</title>
    <Rule id="SV-VCUI-70-000027" severity="medium" weight="10.0">
      <version>VCUI-70-000027</version>
      <title>vSphere UI must have the debug option turned off.</title>
      <description>&lt;VulnDiscussion&gt;Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage, may be displayed. Since this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.

vSphere UI can be configured to set the debugging level. By setting the debugging level to zero, no debugging information will be provided to a malicious user.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001312</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to all &lt;debug&gt; nodes that are not set to "0".

Set the &lt;param-value&gt; to "0" in all &lt;param-name&gt;debug&lt;/param-name&gt; nodes.

Note: The debug setting should look like the following:

               &lt;init-param&gt;
                  &lt;param-name&gt;debug&lt;/param-name&gt;
                  &lt;param-value&gt;0&lt;/param-value&gt;
               &lt;/init-param&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '//param-name[text()="debug"]/parent::init-param' -

Expected result:

&lt;init-param&gt;
      &lt;param-name&gt;debug&lt;/param-name&gt;
      &lt;param-value&gt;0&lt;/param-value&gt;
&lt;/init-param&gt;

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000028">
    <title>SRG-APP-000357-WSR-000150</title>
    <Rule id="SV-VCUI-70-000028" severity="medium" weight="10.0">
      <version>VCUI-70-000028</version>
      <title>vSphere UI must use a logging mechanism that is configured to allocate log record storage capacity large enough to accommodate the logging requirements of the web server.</title>
      <description>&lt;VulnDiscussion&gt;In order to make certain that the logging mechanism used by the web server has sufficient storage capacity in which to write the logs, the logging mechanism needs to be able to allocate log record storage capacity. vSphere UI configures log sizes and roation appropriately as part of it's installation routine. Verifying that the logging configuration file (serviceability.xml) has not been modified is sufficient to determine if the logging configuration has been modified from the default.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001849</ident>
      <fixtext>Reinstall the VCSA or roll back to a snapshot.

Modifying the vSphere UI installation files manually is not supported by VMware.</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# rpm -V vsphere-ui|grep serviceability.xml|grep "^..5......"

If the command returns any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000029">
    <title>SRG-APP-000358-WSR-000163</title>
    <Rule id="SV-VCUI-70-000029" severity="medium" weight="10.0">
      <version>VCUI-70-000029</version>
      <title>vSphere UI log files must be moved to a permanent repository in accordance with site policy.</title>
      <description>&lt;VulnDiscussion&gt;vSphere UI produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensics, or other purposes relevant to ensuring the availability and integrity of the hosted application.

vSphere UI syslog configuration is included by default, as part of the VMware-visl-integration package. The shipping state of the configuration file must be verified and maintained.

Satisfies: SRG-APP-000108-WSR-000166, SRG-APP-000125-WSR-000071&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001851</ident>
      <fixtext>Navigate to and open:

/etc/vmware-syslog/vmware-services-vsphere-ui.conf

Create the file if it does not exist.

Set the contents of the file as follows:

input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere_client_virgo.log"
      Tag="ui-main"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/changelog.log"
      Tag="ui-changelog"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/dataservice.log"
      Tag="ui-dataservice"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/apigw.log"
      Tag="ui-apigw"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/equinox.log"
      Tag="ui-equinox"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/eventlog.log"
      Tag="ui-eventlog"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/httpRequest.log"
      Tag="ui-httpRequest"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/opid.log"
      Tag="ui-opid"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/osgi.log"
      Tag="ui-osgi"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/performanceAudit.log"
      Tag="ui-performanceAudit"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/plugin-medic.log"
      Tag="ui-plugin-medic"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/threadmonitor.log"
      Tag="ui-threadmonitor"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/threadpools.log"
      Tag="ui-threadpools"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vspheremessaging.log"
      Tag="ui-vspheremessaging"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-rpm.log"
      Tag="ui-rpm"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime*"
      Tag="ui-runtime"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/access/localhost_access*"
      Tag="ui-access"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/vsphere-ui-gc*"
      Tag="ui-gc"
      Severity="info"
      Facility="local0")
input(type="imfile"
      File="/var/log/firstboot/vsphere_ui_firstboot*"
      Tag="ui-firstboot"
      Severity="info"
      Facility="local0")</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# rpm -V VMware-visl-integration|grep vmware-services-vsphere-ui.conf|grep "^..5......"

If the command returns any output, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000030">
    <title>SRG-APP-000383-WSR-000175</title>
    <Rule id="SV-VCUI-70-000030" severity="medium" weight="10.0">
      <version>VCUI-70-000030</version>
      <title>vSphere UI must be configured with the appropriate ports.</title>
      <description>&lt;VulnDiscussion&gt;Web servers provide numerous processes, features, and functionalities that utilize TCP/IP ports. Some of these processes may be deemed unnecessary or too unsecure to run on a production system. The ports that vSphere UI listens on are configured in the catalina.properties file and must be veriified as accurate to their shipping state.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-001762</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Navigate to the ports specification section.

Set the vSphere UI port specifications according to the shipping configuration as follows:

http.port=5090
proxy.port=443

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# grep '\.port' /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Expected result:

http.port=5090
proxy.port=443

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000031">
    <title>SRG-APP-000435-WSR-000147</title>
    <Rule id="SV-VCUI-70-000031" severity="medium" weight="10.0">
      <version>VCUI-70-000031</version>
      <title>vSphere UI must disable the shutdown port.</title>
      <description>&lt;VulnDiscussion&gt;An attacker has at least two reasons to stop a web server. The first is to cause a DoS, and the second is to put in place changes the attacker made to the web server configuration. If the Tomcat shutdown port feature is enabled, a shutdown signal can be sent to vSphere UI through this port. To ensure availability, the shutdown port must be disabled.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-002385</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Make sure that the server port is disabled:

&lt;Server port="${shutdown.port}" …&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following commands:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2 s/xmlns=".*"//g' |  xmllint --xpath '/Server/@port' -

Expected result:

port="${shutdown.port}"

If the output does not match the expected result, this is a finding.

# grep shutdown /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json|sed -e 's/^[ ]*//'

Expected result:

"-Dshutdown.port=-1",

If the output does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000032">
    <title>SRG-APP-000439-WSR-000155</title>
    <Rule id="SV-VCUI-70-000032" severity="medium" weight="10.0">
      <version>VCUI-70-000032</version>
      <title>vSphere UI must set the secure flag for cookies.</title>
      <description>&lt;VulnDiscussion&gt;The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text.

By setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel. vSphere UI is configured to only be accessible over a TLS tunnel, but this cookie flag is still a recommended best practice.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-002418</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to the /&lt;web-apps&gt;/&lt;session-config&gt;/&lt;cookie-config&gt; node and configure it as follows.

    &lt;cookie-config&gt;
      &lt;http-only&gt;true&lt;/http-only&gt;
      &lt;secure&gt;true&lt;/secure&gt;
    &lt;/cookie-config&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' -

Expected result:

&lt;secure&gt;true&lt;/secure&gt;

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="VCUI-70-000033">
    <title>SRG-APP-000516-WSR-000174</title>
    <Rule id="SV-VCUI-70-000033" severity="medium" weight="10.0">
      <version>VCUI-70-000033</version>
      <title>vSphere UI default servlet must be set to readonly.</title>
      <description>&lt;VulnDiscussion&gt;The default servlet (or DefaultServlet) is a special servlet provided with Tomcat which is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. The DefaultServlet is configured by default with the "readonly" parameter set to "true" where HTTP commands like PUT and DELETE are rejected.

Changing this to false allows clients to delete or modify static resources on the server and to upload new resources. DefaultServlet readonly must be set to true, either literally or by absence (default).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
      <ident system="http://iase.disa.mil/cci">CCI-000366</ident>
      <fixtext>Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to the /&lt;web-apps&gt;/&lt;servlet&gt;/&lt;servlet-name&gt;default&lt;/servlet-name&gt;/ node and remove the following node:

&lt;init-param&gt;
      &lt;param-name&gt;readonly&lt;/param-name&gt;
      &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext>
      <check system="N/A">
        <check-content>At the command prompt, execute the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '/web-app/servlet/servlet-name[text()="default"]/../init-param/param-name[text()="readonly"]/../param-value[text()="false"]' -

Expected result:

XPath set is empty

If the output of the command does not match the expected result, this is a finding.</check-content>
      </check>
    </Rule>
  </Group>
</Benchmark>
